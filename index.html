<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dulce Pesadilla NavideÃ±a</title>
    <style>
        /* ESTILOS (Limpios para una sola capa) */
        body { margin: 0; padding: 0; background-color: #000; color: white; font-family: sans-serif; overflow: hidden; height: 100vh; display: flex; justify-content: center; align-items: center; }
        
        #game-container { width: 100%; max-width: 450px; height: 100%; position: relative; background-color: #000; overflow: hidden; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        
        /* CAPA ÃšNICA DE FONDO (AquÃ­ va todo: personaje y fondo juntos) */
        #scene-layer { 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background-size: cover; 
            background-position: center; 
            background-repeat: no-repeat;
            transition: background-image 0.4s ease-in-out; /* Suaviza el cambio */
            z-index: 1; 
        }
        
        /* EFECTOS (Sangre, Flash) */
        #effect-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 2; transition: background 0.2s; }
        
        /* INTERFAZ */
        #ui-layer { position: absolute; bottom: 0; left: 0; width: 100%; height: 100%; z-index: 10; display: flex; flex-direction: column; justify-content: flex-end; padding-bottom: 20px; pointer-events: none; }
        
        /* Para que los botones y texto sÃ­ reciban toques */
        .interactive { pointer-events: auto; }

        .text-box { background: rgba(0, 0, 0, 0.85); margin: 10px 15px; padding: 15px; border-radius: 10px; border: 1px solid #444; min-height: 120px; display: flex; flex-direction: column; position: relative; }
        .name-tag { font-weight: bold; color: #ff4d4d; margin-bottom: 8px; text-transform: uppercase; font-size: 0.9em; }
        .dialogue { font-size: 1.05em; line-height: 1.5; color: #eee; }
        
        .choices-container { display: flex; flex-direction: column; gap: 12px; padding: 0 20px; margin-bottom: 15px; }
        .btn { padding: 14px; border-radius: 8px; border: none; cursor: pointer; font-size: 1em; font-weight: bold; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        .btn-normal { background: #333; color: #fff; border: 1px solid #555; }
        .btn-premium { background: linear-gradient(135deg, #b8860b, #ffd700); color: #2b1d00; border: 1px solid #ffcc00; position: relative; font-weight: 800; }
        .btn-premium::after { content: "ðŸ’Ž"; margin-left: 8px; }
        
        .next-arrow { position: absolute; bottom: 10px; right: 15px; color: #aaa; font-size: 1.5em; animation: bounce 1s infinite; cursor: pointer; }
        .hidden { display: none !important; }
        .shake { animation: shake 0.5s; }
        .red-flash { background-color: rgba(200, 0, 0, 0.5) !important; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(5px); } }
        @keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 50% { transform: translate(-1px, 2px) rotate(-1deg); } 100% { transform: translate(1px, -2px) rotate(-1deg); } }
    </style>
</head>
<body>

<div id="game-container">
    <div id="scene-layer"></div>
    <div id="effect-layer"></div>

    <div id="ui-layer">
        <div id="choices-area" class="choices-container interactive hidden"></div>
        <div id="text-area" class="text-box interactive">
            <div id="char-name" class="name-tag"></div>
            <div id="dialogue-text" class="dialogue"></div>
            <div id="next-btn" class="next-arrow">â–¼</div>
        </div>
    </div>
</div>

<script>
    /* === TUS IMÃGENES EXACTAS === */
    const JOHN_SALA = 'santa_sala.jpg';
    const JOHN_CUARTO = 'santa_cuarto.jpg';
    const JOHN_DESVISTE = 'santa_desviste.jpg';
    const JOHN_ASESINO = 'santa_cara_asesino.jpg';
    const JOHN_RIE = 'santa_rie.jpg';
    const JOHN_CERCA = 'santa_cerca.jpg';
    
    const CG_CAMA_ARRIBA = 'santa_cama_abajo.jpg';
    const CG_BESO_MANO = 'beso_mano.jpg';
    const CG_BESO_PIERNA = 'beso_pierna.jpg';
    const CG_LEVANTA_PIERNA = 'levanta_pierna.jpg';
    const CG_NOTA = 'mensaje_final.jpg';
    
    const BG_SALA_LUZ = 'sala_luz.jpg';
    const BG_SALA_OSCURA = 'sala_no_luz.jpg';
    const BG_CUARTO_NOCHE = 'cuarto_noche.jpg';
    const BG_CUARTO_DIA = 'cuarto_revuelto.jpg';
    const BG_MUERTE = 'pantalla_muerte.jpg';
    const BG_NEGRO = '#000'; // Color negro

    /* === HISTORIA === 
       NOTA: Ahora usamos la propiedad "img" para TODO. 
       Ya no separamos fondo y personaje. 
    */
    const story = {
        "start": {
            img: BG_NEGRO,
            text: "Dicen que la Navidad es mÃ¡gica... Pero para mÃ­, sola en casa, es solo silencio.",
            name: "TÃº",
            next: "sala_intro"
        },
        "sala_intro": {
            img: BG_SALA_LUZ, 
            text: "LleguÃ© del trabajo arrastrando los pies. Â¿Para quÃ© decorÃ© si estoy sola? De niÃ±a esperaba a Santa, pero nunca llegÃ³.",
            name: "TÃº",
            next: "apagar_luz"
        },
        "apagar_luz": {
            img: BG_SALA_OSCURA,
            text: "Mejor apago todo y me voy a dormir. No tiene sentido seguir despierta.",
            name: "TÃº",
            next: "ruido"
        },
        "ruido": {
            img: BG_SALA_OSCURA,
            sound: "shake",
            text: "Â¡CRASH! ... Â¿QuÃ©...? Â¿QuÃ© fue eso? JurarÃ­a que cerrÃ© la puerta con llave.",
            name: "TÃº",
            choices: [
                { text: "Tengo miedo (Esconderme)", target: "muerte_1", type: "normal" },
                { text: "Investigar el ruido", target: "encuentro", type: "premium" }
            ]
        },
        // --- MUERTE 1 ---
        "muerte_1": {
            img: BG_NEGRO,
            text: "Me escondo bajo las sÃ¡banas... Escucho pasos... 'Te encontrÃ©'.",
            name: "Voz",
            next: "game_over_1"
        },
        "game_over_1": {
            img: BG_MUERTE, 
            text: "SentÃ­ un golpe seco y luego oscuridad. [FINAL MALO]",
            name: "Sistema",
            restart: true
        },
        // --- ENCUENTRO ---
        "encuentro": {
            img: JOHN_SALA, // USAMOS LA IMAGEN COMPLETA DE JOHN EN LA SALA
            text: "Salgo a la sala. Hay un hombre vestido de Santa Claus... Espera. Es Ã©l. John Red, el asesino de las noticias.",
            name: "TÃº",
            next: "encuentro_2"
        },
        "encuentro_2": {
            img: JOHN_ASESINO, // USAMOS LA CARA DE ASESINO
            text: "Vaya bienvenida... Â¿Es asÃ­ como tratas a Santa cuando viene a visitarte?",
            name: "John Red",
            choices: [
                { text: "Â¡SÃ© quiÃ©n eres! (Confrontar)", target: "muerte_2", type: "normal" },
                { text: "Seguirle el juego (Seducir)", target: "seducion_1", type: "premium" }
            ]
        },
        "muerte_2": {
            img: JOHN_ASESINO,
            text: "QuÃ© pena... odio cuando rompen la inmersiÃ³n. SerÃ¡ rÃ¡pido.",
            name: "John Red",
            next: "game_over_2"
        },
        "game_over_2": {
            img: BG_MUERTE,
            text: "El cuchillo brilla antes de clavarse en mi pecho. [FINAL MALO]",
            name: "Sistema",
            restart: true
        },
        "seducion_1": {
            img: JOHN_RIE,
            text: "Vaya... No sabÃ­a que Santa serÃ­a tan joven y atractivo.",
            name: "TÃº",
            next: "seducion_2"
        },
        "seducion_2": {
            img: JOHN_SALA,
            text: "Jajaja... Interesante. Dime, Â¿has sido una chica mala este aÃ±o?",
            name: "John Red",
            choices: [
                { text: "He sido buena...", target: "muerte_3", type: "normal" },
                { text: "He sido buena... pero quiero ser mala.", target: "cuarto_intro", type: "premium" }
            ]
        },
        "muerte_3": {
            img: BG_MUERTE,
            text: "Las chicas buenas son aburridas. [FINAL MALO: ABURRIDO]",
            name: "John Red",
            restart: true
        },
        "cuarto_intro": {
            img: JOHN_CERCA,
            text: "Me agarra de la cintura. 'Santa no acepta devoluciones'.",
            name: "John Red",
            next: "cama_cg"
        },
        "cama_cg": {
            img: CG_CAMA_ARRIBA, 
            text: "De repente estoy en la cama. Ã‰l me mira desde arriba con esa intensidad depredadora.",
            name: "NarraciÃ³n",
            next: "desvestirse"
        },
        "desvestirse": {
            img: JOHN_DESVISTE, 
            text: "'Â¿No tienes calor?' Se abre el traje. Sus abdominales son perfectos.",
            name: "TÃº",
            next: "opcion_desnudo"
        },
        "opcion_desnudo": {
            img: JOHN_DESVISTE,
            text: "'Â¿Por quÃ© no desenvuelves tÃº misma el regalo?'",
            name: "John Red",
            choices: [
                { text: "Bajarle los pantalones", target: "sexo_oral", type: "premium" },
                { text: "Que lo haga Ã©l (Voyeur)", target: "sexo_oral", type: "premium" }
            ]
        },
        "sexo_oral": {
            img: BG_NEGRO,
            text: "Me empuja a la cama. 'Voy a comerme este pastel'.",
            name: "John Red",
            next: "cg_beso_mano"
        },
        "cg_beso_mano": {
            img: CG_BESO_MANO,
            text: "Besa mi mano con una caballerosidad falsa y oscura...",
            name: "NarraciÃ³n",
            next: "cg_levanta"
        },
        "cg_levanta": {
            img: CG_LEVANTA_PIERNA,
            text: "Levanta mi pierna con firmeza. Siento el frÃ­o del aire y el calor de su mano.",
            name: "NarraciÃ³n",
            next: "cg_beso_pierna"
        },
        "cg_beso_pierna": {
            img: CG_BESO_PIERNA,
            text: "Sus labios recorren mi muslo... acercÃ¡ndose peligrosamente a mi centro.",
            name: "NarraciÃ³n",
            next: "acto_final"
        },
        "acto_final": {
            img: CG_CAMA_ARRIBA,
            text: "Se posiciona entre mis piernas. 'Â¿Sigo?'.",
            name: "John Red",
            choices: [
                { text: "No pares", target: "final_comun", type: "normal" },
                { text: "Ni se te ocurra parar", target: "final_comun", type: "premium" }
            ]
        },
        "final_comun": {
            img: BG_NEGRO,
            text: "Entra de golpe. Pasamos la noche entre gemidos y violencia contenida... hasta que caemos rendidos.",
            name: "NarraciÃ³n",
            next: "manana"
        },
        "manana": {
            img: BG_CUARTO_DIA,
            text: "Despierto adolorida. La cama estÃ¡ vacÃ­a y revuelta. Â¿Fue un sueÃ±o? No... hay una nota.",
            name: "TÃº",
            next: "ver_nota"
        },
        "ver_nota": {
            img: CG_NOTA,
            text: "'Espero que no me olvides. Espera mi regalo la prÃ³xima Navidad. - Tu Santa'.",
            name: "Nota",
            next: "fin"
        },
        "fin": {
            img: BG_NEGRO,
            text: "FIN DEL CAPÃTULO 1.",
            name: "Sistema",
            restart: true
        }
    };

    /* MOTOR DEL JUEGO SIMPLIFICADO */
    const sceneLayer = document.getElementById("scene-layer");
    const textName = document.getElementById("char-name");
    const textDialog = document.getElementById("dialogue-text");
    const nextBtn = document.getElementById("next-btn");
    const choicesArea = document.getElementById("choices-area");
    const effectLayer = document.getElementById("effect-layer");

    function renderNode(nodeId) {
        const node = story[nodeId];
        nextBtn.classList.remove("hidden");
        choicesArea.classList.add("hidden");
        choicesArea.innerHTML = "";
        effectLayer.className = ""; 

        // RENDERIZAR IMAGEN ÃšNICA
        if (node.img) {
            if (node.img.startsWith("#")) {
                sceneLayer.style.backgroundImage = "none";
                sceneLayer.style.backgroundColor = node.img;
            } else {
                sceneLayer.style.backgroundColor = "#000";
                // AquÃ­ asignamos la imagen directamente como fondo
                sceneLayer.style.backgroundImage = `url('${node.img}')`; 
            }
        }

        textName.textContent = node.name || "";
        textDialog.textContent = node.text || "...";

        if (node.sound === "shake") {
            document.body.classList.add("shake");
            setTimeout(() => document.body.classList.remove("shake"), 500);
        }

        if (node.choices) {
            nextBtn.classList.add("hidden");
            choicesArea.classList.remove("hidden");
            node.choices.forEach(choice => {
                const btn = document.createElement("button");
                btn.className = choice.type === "premium" ? "btn btn-premium" : "btn btn-normal";
                btn.textContent = choice.text;
                btn.onclick = () => renderNode(choice.target);
                choicesArea.appendChild(btn);
            });
        } else if (node.restart) {
            nextBtn.onclick = () => location.reload();
            nextBtn.textContent = "â†» Reiniciar";
        } else {
            nextBtn.onclick = () => renderNode(node.next);
            nextBtn.textContent = "â–¼";
        }
    }

    window.onload = () => { renderNode("start"); };
</script>
</body>
</html><!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dulce Pesadilla NavideÃ±a</title>
    <style>
        /* ESTILOS (Limpios para una sola capa) */
        body { margin: 0; padding: 0; background-color: #000; color: white; font-family: sans-serif; overflow: hidden; height: 100vh; display: flex; justify-content: center; align-items: center; }
        
        #game-container { width: 100%; max-width: 450px; height: 100%; position: relative; background-color: #000; overflow: hidden; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        
        /* CAPA ÃšNICA DE FONDO (AquÃ­ va todo: personaje y fondo juntos) */
        #scene-layer { 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background-size: cover; 
            background-position: center; 
            background-repeat: no-repeat;
            transition: background-image 0.4s ease-in-out; /* Suaviza el cambio */
            z-index: 1; 
        }
        
        /* EFECTOS (Sangre, Flash) */
        #effect-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 2; transition: background 0.2s; }
        
        /* INTERFAZ */
        #ui-layer { position: absolute; bottom: 0; left: 0; width: 100%; height: 100%; z-index: 10; display: flex; flex-direction: column; justify-content: flex-end; padding-bottom: 20px; pointer-events: none; }
        
        /* Para que los botones y texto sÃ­ reciban toques */
        .interactive { pointer-events: auto; }

        .text-box { background: rgba(0, 0, 0, 0.85); margin: 10px 15px; padding: 15px; border-radius: 10px; border: 1px solid #444; min-height: 120px; display: flex; flex-direction: column; position: relative; }
        .name-tag { font-weight: bold; color: #ff4d4d; margin-bottom: 8px; text-transform: uppercase; font-size: 0.9em; }
        .dialogue { font-size: 1.05em; line-height: 1.5; color: #eee; }
        
        .choices-container { display: flex; flex-direction: column; gap: 12px; padding: 0 20px; margin-bottom: 15px; }
        .btn { padding: 14px; border-radius: 8px; border: none; cursor: pointer; font-size: 1em; font-weight: bold; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        .btn-normal { background: #333; color: #fff; border: 1px solid #555; }
        .btn-premium { background: linear-gradient(135deg, #b8860b, #ffd700); color: #2b1d00; border: 1px solid #ffcc00; position: relative; font-weight: 800; }
        .btn-premium::after { content: "ðŸ’Ž"; margin-left: 8px; }
        
        .next-arrow { position: absolute; bottom: 10px; right: 15px; color: #aaa; font-size: 1.5em; animation: bounce 1s infinite; cursor: pointer; }
        .hidden { display: none !important; }
        .shake { animation: shake 0.5s; }
        .red-flash { background-color: rgba(200, 0, 0, 0.5) !important; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(5px); } }
        @keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 50% { transform: translate(-1px, 2px) rotate(-1deg); } 100% { transform: translate(1px, -2px) rotate(-1deg); } }
    </style>
</head>
<body>

<div id="game-container">
    <div id="scene-layer"></div>
    <div id="effect-layer"></div>

    <div id="ui-layer">
        <div id="choices-area" class="choices-container interactive hidden"></div>
        <div id="text-area" class="text-box interactive">
            <div id="char-name" class="name-tag"></div>
            <div id="dialogue-text" class="dialogue"></div>
            <div id="next-btn" class="next-arrow">â–¼</div>
        </div>
    </div>
</div>

<script>
    /* === TUS IMÃGENES EXACTAS === */
    const JOHN_SALA = 'santa_sala.jpg';
    const JOHN_CUARTO = 'santa_cuarto.jpg';
    const JOHN_DESVISTE = 'santa_desviste.jpg';
    const JOHN_ASESINO = 'santa_cara_asesino.jpg';
    const JOHN_RIE = 'santa_rie.jpg';
    const JOHN_CERCA = 'santa_cerca.jpg';
    
    const CG_CAMA_ARRIBA = 'santa_cama_abajo.jpg';
    const CG_BESO_MANO = 'beso_mano.jpg';
    const CG_BESO_PIERNA = 'beso_pierna.jpg';
    const CG_LEVANTA_PIERNA = 'levanta_pierna.jpg';
    const CG_NOTA = 'mensaje_final.jpg';
    
    const BG_SALA_LUZ = 'sala_luz.jpg';
    const BG_SALA_OSCURA = 'sala_no_luz.jpg';
    const BG_CUARTO_NOCHE = 'cuarto_noche.jpg';
    const BG_CUARTO_DIA = 'cuarto_revuelto.jpg';
    const BG_MUERTE = 'pantalla_muerte.jpg';
    const BG_NEGRO = '#000'; // Color negro

    /* === HISTORIA === 
       NOTA: Ahora usamos la propiedad "img" para TODO. 
       Ya no separamos fondo y personaje. 
    */
    const story = {
        "start": {
            img: BG_NEGRO,
            text: "Dicen que la Navidad es mÃ¡gica... Pero para mÃ­, sola en casa, es solo silencio.",
            name: "TÃº",
            next: "sala_intro"
        },
        "sala_intro": {
            img: BG_SALA_LUZ, 
            text: "LleguÃ© del trabajo arrastrando los pies. Â¿Para quÃ© decorÃ© si estoy sola? De niÃ±a esperaba a Santa, pero nunca llegÃ³.",
            name: "TÃº",
            next: "apagar_luz"
        },
        "apagar_luz": {
            img: BG_SALA_OSCURA,
            text: "Mejor apago todo y me voy a dormir. No tiene sentido seguir despierta.",
            name: "TÃº",
            next: "ruido"
        },
        "ruido": {
            img: BG_SALA_OSCURA,
            sound: "shake",
            text: "Â¡CRASH! ... Â¿QuÃ©...? Â¿QuÃ© fue eso? JurarÃ­a que cerrÃ© la puerta con llave.",
            name: "TÃº",
            choices: [
                { text: "Tengo miedo (Esconderme)", target: "muerte_1", type: "normal" },
                { text: "Investigar el ruido", target: "encuentro", type: "premium" }
            ]
        },
        // --- MUERTE 1 ---
        "muerte_1": {
            img: BG_NEGRO,
            text: "Me escondo bajo las sÃ¡banas... Escucho pasos... 'Te encontrÃ©'.",
            name: "Voz",
            next: "game_over_1"
        },
        "game_over_1": {
            img: BG_MUERTE, 
            text: "SentÃ­ un golpe seco y luego oscuridad. [FINAL MALO]",
            name: "Sistema",
            restart: true
        },
        // --- ENCUENTRO ---
        "encuentro": {
            img: JOHN_SALA, // USAMOS LA IMAGEN COMPLETA DE JOHN EN LA SALA
            text: "Salgo a la sala. Hay un hombre vestido de Santa Claus... Espera. Es Ã©l. John Red, el asesino de las noticias.",
            name: "TÃº",
            next: "encuentro_2"
        },
        "encuentro_2": {
            img: JOHN_ASESINO, // USAMOS LA CARA DE ASESINO
            text: "Vaya bienvenida... Â¿Es asÃ­ como tratas a Santa cuando viene a visitarte?",
            name: "John Red",
            choices: [
                { text: "Â¡SÃ© quiÃ©n eres! (Confrontar)", target: "muerte_2", type: "normal" },
                { text: "Seguirle el juego (Seducir)", target: "seducion_1", type: "premium" }
            ]
        },
        "muerte_2": {
            img: JOHN_ASESINO,
            text: "QuÃ© pena... odio cuando rompen la inmersiÃ³n. SerÃ¡ rÃ¡pido.",
            name: "John Red",
            next: "game_over_2"
        },
        "game_over_2": {
            img: BG_MUERTE,
            text: "El cuchillo brilla antes de clavarse en mi pecho. [FINAL MALO]",
            name: "Sistema",
            restart: true
        },
        "seducion_1": {
            img: JOHN_RIE,
            text: "Vaya... No sabÃ­a que Santa serÃ­a tan joven y atractivo.",
            name: "TÃº",
            next: "seducion_2"
        },
        "seducion_2": {
            img: JOHN_SALA,
            text: "Jajaja... Interesante. Dime, Â¿has sido una chica mala este aÃ±o?",
            name: "John Red",
            choices: [
                { text: "He sido buena...", target: "muerte_3", type: "normal" },
                { text: "He sido buena... pero quiero ser mala.", target: "cuarto_intro", type: "premium" }
            ]
        },
        "muerte_3": {
            img: BG_MUERTE,
            text: "Las chicas buenas son aburridas. [FINAL MALO: ABURRIDO]",
            name: "John Red",
            restart: true
        },
        "cuarto_intro": {
            img: JOHN_CERCA,
            text: "Me agarra de la cintura. 'Santa no acepta devoluciones'.",
            name: "John Red",
            next: "cama_cg"
        },
        "cama_cg": {
            img: CG_CAMA_ARRIBA, 
            text: "De repente estoy en la cama. Ã‰l me mira desde arriba con esa intensidad depredadora.",
            name: "NarraciÃ³n",
            next: "desvestirse"
        },
        "desvestirse": {
            img: JOHN_DESVISTE, 
            text: "'Â¿No tienes calor?' Se abre el traje. Sus abdominales son perfectos.",
            name: "TÃº",
            next: "opcion_desnudo"
        },
        "opcion_desnudo": {
            img: JOHN_DESVISTE,
            text: "'Â¿Por quÃ© no desenvuelves tÃº misma el regalo?'",
            name: "John Red",
            choices: [
                { text: "Bajarle los pantalones", target: "sexo_oral", type: "premium" },
                { text: "Que lo haga Ã©l (Voyeur)", target: "sexo_oral", type: "premium" }
            ]
        },
        "sexo_oral": {
            img: BG_NEGRO,
            text: "Me empuja a la cama. 'Voy a comerme este pastel'.",
            name: "John Red",
            next: "cg_beso_mano"
        },
        "cg_beso_mano": {
            img: CG_BESO_MANO,
            text: "Besa mi mano con una caballerosidad falsa y oscura...",
            name: "NarraciÃ³n",
            next: "cg_levanta"
        },
        "cg_levanta": {
            img: CG_LEVANTA_PIERNA,
            text: "Levanta mi pierna con firmeza. Siento el frÃ­o del aire y el calor de su mano.",
            name: "NarraciÃ³n",
            next: "cg_beso_pierna"
        },
        "cg_beso_pierna": {
            img: CG_BESO_PIERNA,
            text: "Sus labios recorren mi muslo... acercÃ¡ndose peligrosamente a mi centro.",
            name: "NarraciÃ³n",
            next: "acto_final"
        },
        "acto_final": {
            img: CG_CAMA_ARRIBA,
            text: "Se posiciona entre mis piernas. 'Â¿Sigo?'.",
            name: "John Red",
            choices: [
                { text: "No pares", target: "final_comun", type: "normal" },
                { text: "Ni se te ocurra parar", target: "final_comun", type: "premium" }
            ]
        },
        "final_comun": {
            img: BG_NEGRO,
            text: "Entra de golpe. Pasamos la noche entre gemidos y violencia contenida... hasta que caemos rendidos.",
            name: "NarraciÃ³n",
            next: "manana"
        },
        "manana": {
            img: BG_CUARTO_DIA,
            text: "Despierto adolorida. La cama estÃ¡ vacÃ­a y revuelta. Â¿Fue un sueÃ±o? No... hay una nota.",
            name: "TÃº",
            next: "ver_nota"
        },
        "ver_nota": {
            img: CG_NOTA,
            text: "'Espero que no me olvides. Espera mi regalo la prÃ³xima Navidad. - Tu Santa'.",
            name: "Nota",
            next: "fin"
        },
        "fin": {
            img: BG_NEGRO,
            text: "FIN DEL CAPÃTULO 1.",
            name: "Sistema",
            restart: true
        }
    };

    /* MOTOR DEL JUEGO SIMPLIFICADO */
    const sceneLayer = document.getElementById("scene-layer");
    const textName = document.getElementById("char-name");
    const textDialog = document.getElementById("dialogue-text");
    const nextBtn = document.getElementById("next-btn");
    const choicesArea = document.getElementById("choices-area");
    const effectLayer = document.getElementById("effect-layer");

    function renderNode(nodeId) {
        const node = story[nodeId];
        nextBtn.classList.remove("hidden");
        choicesArea.classList.add("hidden");
        choicesArea.innerHTML = "";
        effectLayer.className = ""; 

        // RENDERIZAR IMAGEN ÃšNICA
        if (node.img) {
            if (node.img.startsWith("#")) {
                sceneLayer.style.backgroundImage = "none";
                sceneLayer.style.backgroundColor = node.img;
            } else {
                sceneLayer.style.backgroundColor = "#000";
                // AquÃ­ asignamos la imagen directamente como fondo
                sceneLayer.style.backgroundImage = `url('${node.img}')`; 
            }
        }

        textName.textContent = node.name || "";
        textDialog.textContent = node.text || "...";

        if (node.sound === "shake") {
            document.body.classList.add("shake");
            setTimeout(() => document.body.classList.remove("shake"), 500);
        }

        if (node.choices) {
            nextBtn.classList.add("hidden");
            choicesArea.classList.remove("hidden");
            node.choices.forEach(choice => {
                const btn = document.createElement("button");
                btn.className = choice.type === "premium" ? "btn btn-premium" : "btn btn-normal";
                btn.textContent = choice.text;
                btn.onclick = () => renderNode(choice.target);
                choicesArea.appendChild(btn);
            });
        } else if (node.restart) {
            nextBtn.onclick = () => location.reload();
            nextBtn.textContent = "â†» Reiniciar";
        } else {
            nextBtn.onclick = () => renderNode(node.next);
            nextBtn.textContent = "â–¼";
        }
    }

    window.onload = () => { renderNode("start"); };
</script>
</body>
</html>
