<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dulce Pesadilla Navideña</title>
    <style>
        /* ESTILOS GENERALES */
        * { box-sizing: border-box; }
        body { margin: 0; padding: 0; background-color: #000; color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; height: 100vh; display: flex; justify-content: center; align-items: center; }
        #game-container { width: 100%; max-width: 450px; height: 100%; position: relative; background-color: #000; overflow: hidden; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        
        /* PANTALLA DE INICIO (NOMBRE) */
        #start-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #000; z-index: 50;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            padding: 30px; text-align: center;
        }
        .title { color: #ff4d4d; font-size: 2em; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 2px; font-weight: bold; }
        .subtitle { color: #aaa; margin-bottom: 40px; font-size: 1em; }
        input[type="text"] {
            background: #222; border: 1px solid #555; color: white;
            padding: 15px; font-size: 1.2em; border-radius: 8px;
            width: 100%; text-align: center; margin-bottom: 20px;
            outline: none;
        }
        input:focus { border-color: #ff4d4d; }

        /* SISTEMA DE IMAGEN */
        .scene-layer { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background-size: cover; background-position: center; background-repeat: no-repeat;
            z-index: 1;
        }
        #scene-layer-back { z-index: 1; }
        #scene-layer-front { z-index: 2; opacity: 0; transition: opacity 0.5s ease-in-out; }
        .fade-in { opacity: 1 !important; }

        /* INTERFAZ */
        #ui-layer { 
            position: absolute; bottom: 0; left: 0; width: 100%; height: 100%; 
            z-index: 10; display: flex; flex-direction: column; justify-content: flex-end; 
            padding: 20px; pointer-events: none; 
        }
        .interactive { pointer-events: auto; }

        /* CAJA DE TEXTO */
        .text-box { 
            background: rgba(0, 0, 0, 0.85); 
            width: 100%; padding: 20px; border-radius: 12px; border: 1px solid #555; 
            min-height: 130px; display: flex; flex-direction: column; position: relative; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }
        .name-tag { font-weight: bold; color: #ff4d4d; margin-bottom: 10px; text-transform: uppercase; font-size: 0.95em; letter-spacing: 1px; }
        .dialogue { font-size: 1.1em; line-height: 1.5; color: #eee; margin-bottom: 20px; }
        .next-arrow { position: absolute; bottom: 10px; right: 15px; color: #aaa; font-size: 1.5em; cursor: pointer; animation: bounce 1s infinite; }

        /* BOTONES */
        .choices-container { display: flex; flex-direction: column; gap: 10px; width: 100%; margin-bottom: 15px; }
        .btn { 
            padding: 15px; border-radius: 8px; border: 1px solid #555; cursor: pointer; 
            font-size: 1em; font-weight: bold; text-align: center; width: 100%;
            background: #222; color: white; transition: background 0.2s;
        }
        .btn-start { background: linear-gradient(135deg, #b80b0b, #ff0000); border: none; font-size: 1.2em; }
        .btn:active { transform: scale(0.98); }
        
        .hidden { display: none !important; }
        
        /* EFECTOS */
        .shake { animation: shake 0.5s; }
        .red-flash { position: absolute; top:0; left:0; width:100%; height:100%; background: red; opacity: 0; pointer-events: none; z-index: 20; transition: opacity 0.2s; }
        .flash-active { opacity: 0.5 !important; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(5px); } }
        @keyframes shake { 0% { transform: translate(1px, 1px); } 25% { transform: translate(-2px, -2px); } 50% { transform: translate(2px, 2px); } 75% { transform: translate(-1px, -1px); } }
    </style>
</head>
<body>

<div id="game-container">
    
    <div id="start-screen">
        <div class="title">Dulce Pesadilla</div>
        <div class="subtitle">Especial de Navidad</div>
        <input type="text" id="player-name-input" placeholder="Escribe tu nombre..." maxlength="12">
        <button id="start-btn" class="btn btn-start">COMENZAR</button>
    </div>

    <div id="scene-layer-back" class="scene-layer"></div>
    <div id="scene-layer-front" class="scene-layer"></div>
    <div id="flash-overlay" class="red-flash"></div>

    <div id="ui-layer">
        <div id="choices-area" class="choices-container interactive hidden"></div>
        <div id="text-area" class="text-box interactive hidden">
            <div id="char-name" class="name-tag"></div>
            <div id="dialogue-text" class="dialogue"></div>
            <div id="next-btn" class="next-arrow">▼</div>
        </div>
    </div>
</div>

<script>
    /* === NOMBRES DE ARCHIVO EXACTOS === */
    const BG_NEGRO = '#000';
    const SALA_LUZ = 'sala_luz.jpg';
    const SALA_NO_LUZ = 'sala_no_luz.jpg';
    const CUARTO_NOCHE = 'cuarto_noche.jpg';
    const PANTALLA_MUERTE = 'pantalla_muerte.jpg';
    const PUERTA_SALIR = 'puerta_salir.jpg';
    
    const JOHN_SALA = 'santa_sala.jpg';
    const JOHN_ASESINO = 'santa_cara_asesino.jpg';
    const JOHN_RIE = 'santa_rie.jpg';
    const JOHN_CUARTO = 'santa_cuarto.jpg';

    /* === HISTORIA === */
    const story = {
        "start": {
            img: BG_NEGRO,
            text: "Dicen que la Navidad es la época más mágica del año...",
            name: "Tú",
            next: "intro_2"
        },
        "intro_2": {
            img: BG_NEGRO,
            text: "Risas, familia, regalos bajo el árbol.",
            name: "Tú",
            next: "intro_3"
        },
        "intro_3": {
            img: BG_NEGRO,
            text: "Pero para mí... es solo otra noche de silencio ensordecedor.",
            name: "Tú",
            next: "sala_1"
        },
        "sala_1": {
            img: SALA_LUZ,
            text: "Llegué del trabajo arrastrando los pies. El frío se me ha metido hasta los huesos",
            name: "Tú",
            next: "sala_2"
        },
        "sala_2": {
            img: SALA_LUZ,
            text: "Mira este lugar... Lleno de luces y adornos.",
            name: "Tú",
            next: "sala_3"
        },
        "sala_3": {
            img: SALA_LUZ,
            text: "¿Para qué me molesté en decorar si vivo sola? Supongo que es la costumbre.",
            name: "Tú",
            next: "sala_4"
        },
        "sala_4": {
            img: SALA_LUZ,
            text: "Haa... Es irónico...",
            name: "Tú",
            next: "sala_5"
        },
        "sala_5": {
            img: SALA_LUZ,
            text: "De pequeña, solía esconderme detrás de este mismo sofá.",
            name: "Tú",
            next: "sala_6"
        },
        "sala_6": {
            img: SALA_LUZ,
            text: "Aguantaba la respiración, esperando ver a Santa Claus bajar por la chimenea.",
            name: "Tú",
            next: "sala_7"
        },
        "sala_7": {
            img: SALA_LUZ,
            text: "Nunca lo vi. El sueño siempre me vencía antes de medianoche.",
            name: "Tú",
            next: "sala_8"
        },
        "sala_8": {
            img: SALA_LUZ,
            text: "Cosas de niños ingenuos. Los milagros no bajan por la chimenea. En la vida real, si alguien entra en tu casa a medianoche...",
            name: "Tú",
            next: "sala_9"
        },
        "sala_9": {
            img: SALA_LUZ,
            text: "...probablemente no venga a dejar regalos.",
            name: "Tú",
            effect: "flash",
            next: "sala_10"
        },
        "sala_10": {
            img: SALA_LUZ,
            text: "Basta de melancolía. Mañana será otro día.",
            name: "Tú",
            next: "sala_11"
        },
        "sala_11": {
            img: SALA_LUZ,
            text: "Apagaré todo y me iré a la cama.",
            name: "Tú",
            next: "sala_noluz"
        },
        "sala_noluz": {
            img: SALA_NO_LUZ,
            text: "Solo quiero dormir y olvidar que es Navidad.",
            name: "Tú",
            next: "cuarto_crash"
        },

        // --- EL CRASH ---
        "cuarto_crash": {
            img: CUARTO_NOCHE,
            sound: "shake",
            text: "CRASH",
            name: "Sonido",
            next: "cuarto_reaccion"
        },
        "cuarto_reaccion": {
            img: CUARTO_NOCHE,
            text: "¿Qué...? ¿Qué fue eso?",
            name: "Tú",
            next: "cuarto_pensamiento"
        },
        "cuarto_pensamiento": {
            img: CUARTO_NOCHE,
            text: "Juraría que cerré la puerta con llave.",
            name: "Tú",
            choices: [
                { text: "Tengo mucho miedo... mejor me escondo bajo las sábanas y finjo dormir.", target: "ruta_a" },
                { text: "No voy a ser una víctima. Voy a la sala a investigar.", target: "ruta_b" }
            ]
        },

        // --- RUTA A: MIEDO ---
        "ruta_a": {
            img: BG_NEGRO,
            text: "No... no quiero ver. Si no me muevo, quizás se vaya.",
            name: "Tú",
            next: "miedo_2"
        },
        "miedo_2": {
            img: BG_NEGRO,
            text: "Cierro los ojos con fuerza. Mi corazón late tan fuerte que me duele el pecho.",
            name: "Tú",
            next: "miedo_3"
        },
        "miedo_3": {
            img: BG_NEGRO,
            text: "Escucho pasos. Pesados. Lentos. Se acercan a la cama...",
            name: "Tú",
            next: "miedo_4"
        },
        "miedo_4": {
            img: BG_NEGRO,
            text: "Se detienen justo a mi lado.",
            name: "Tú",
            next: "miedo_5"
        },
        "miedo_5": {
            img: BG_NEGRO,
            text: "Por favor, que sea un sueño, por favor...",
            name: "Tú",
            next: "voz_miedo"
        },
        "voz_miedo": {
            img: BG_NEGRO,
            text: "Te encontré...",
            name: "Voz Desconocida",
            sound: "shake",
            next: "muerte_1"
        },
        "muerte_1": {
            img: PANTALLA_MUERTE,
            text: "Ni siquiera me dio tiempo a gritar...",
            name: "Tú",
            next: "muerte_1_2"
        },
        "muerte_1_2": {
            img: PANTALLA_MUERTE,
            text: "Sentí un estallido de dolor en la cabeza... frío... y luego nada.",
            name: "Tú",
            next: "fin_malo_1"
        },
        "fin_malo_1": {
            img: BG_NEGRO,
            text: "[FINAL MALO 1: Muerte entre sábanas]",
            name: "GAME OVER",
            restart: true
        },

        // --- RUTA B: INVESTIGAR ---
        "ruta_b": {
            img: SALA_NO_LUZ,
            text: "Me armé de valor y salí.",
            name: "Tú",
            next: "santa_sala"
        },
        "santa_sala": {
            img: JOHN_SALA,
            text: "Allí estaba él. Un hombre alto... ¿vestido de Santa Claus?",
            name: "Tú",
            next: "santa_espera"
        },
        "santa_espera": {
            img: JOHN_SALA,
            text: "Pero... espera.",
            name: "Tú",
            next: "santa_cara"
        },
        "santa_cara": {
            img: JOHN_SALA,
            text: "Esa sonrisa... Esa mirada roja y fría...",
            name: "Tú",
            next: "santa_reconocimiento"
        },
        "santa_reconocimiento": {
            img: JOHN_SALA,
            text: "Mi sangre se hiela. Lo he visto en las noticias esta mañana mientras tomaba café.",
            name: "Tú",
            next: "santa_identidad"
        },
        "santa_identidad": {
            img: JOHN_SALA,
            text: "Es él. 'El Asesino de Nochebuena'. John Red.",
            name: "Tú",
            next: "santa_contexto"
        },
        "santa_contexto": {
            img: JOHN_SALA,
            text: "Buscan a un psicópata que se escapó del psiquiátrico de alta seguridad hace dos días.",
            name: "Tú",
            next: "santa_peligro"
        },
        "santa_peligro": {
            img: JOHN_SALA,
            text: "Dijeron que era extremadamente peligroso y manipulador.",
            name: "Tú",
            next: "santa_panico"
        },
        "santa_panico": {
            img: JOHN_SALA,
            text: "Dios mío... ¿Por qué yo? ¿Por qué mi casa?",
            name: "Tú",
            next: "santa_pensar"
        },
        "santa_pensar": {
            img: JOHN_SALA,
            text: "Tengo que pensar rápido. Si nota que tengo miedo, estoy muerta.",
            name: "Tú",
            next: "john_habla"
        },
        "john_habla": {
            img: JOHN_SALA,
            text: "Vaya bienvenida. ¿Es así como tratas a Santa cuando viene a visitarte?",
            name: "John Red",
            choices: [
                { text: "Sé que no eres Santa. ¡Eres John Red!", target: "ruta_confrontar" },
                { text: "Acercarme sonriendo y seguirle el juego.", target: "ruta_seducir" }
            ]
        },

        // --- RUTA CONFRONTAR (FINAL MALO 2) ---
        "ruta_confrontar": {
            img: JOHN_SALA,
            text: "¡Déjate de juegos! ¡Sé quién eres! Eres John Red. Te vi en las noticias. ¡Aléjate de mí, ya llamé a la policía!",
            name: "Tú",
            next: "john_tsk"
        },
        "john_tsk": {
            img: JOHN_SALA,
            text: "...Tsk. Qué aguafiestas. Oh, así que sabes quién soy... Qué pena.",
            name: "John Red",
            next: "john_inmersion"
        },
        "john_inmersion": {
            img: JOHN_SALA,
            text: "Odio cuando arruinan la inmersión del personaje.",
            name: "John Red",
            next: "john_rapido"
        },
        "john_rapido": {
            img: JOHN_ASESINO,
            text: "Supongo que esto será más rápido de lo que pensé.",
            name: "John Red",
            next: "puerta_huir"
        },
        "puerta_huir": {
            img: PUERTA_SALIR,
            text: "¡Espera, no-!",
            name: "Tú",
            next: "puerta_huir_2"
        },
        "puerta_huir_2": {
            img: PUERTA_SALIR,
            text: "Debo salir rápido....",
            name: "Tú",
            next: "muerte_2"
        },
        "muerte_2": {
            img: PANTALLA_MUERTE,
            text: "Es inhumano... Se movió más rápido que mi propia sombra.",
            name: "Tú",
            next: "muerte_2_2"
        },
        "muerte_2_2": {
            img: PANTALLA_MUERTE,
            text: "El cuchillo... quema...",
            name: "Tú",
            next: "fin_malo_2"
        },
        "fin_malo_2": {
            img: BG_NEGRO,
            text: "[FINAL MALO 2: Enfrentarlo no es una Opción]",
            name: "GAME OVER",
            restart: true
        },

        // --- RUTA SEDUCIR ---
        "ruta_seducir": {
            img: JOHN_SALA,
            text: "Tranquila... Respira. Si corro, me caza como a un animal.",
            name: "Tú",
            next: "seducir_2"
        },
        "seducir_2": {
            img: JOHN_SALA,
            text: "Tengo que jugar su juego. Tengo que ser más lista.",
            name: "Tú",
            next: "seducir_3"
        },
        "seducir_3": {
            img: JOHN_SALA,
            text: "Voy a apostarlo todo a una carta: su ego.",
            name: "Tú",
            next: "seducir_habla"
        },
        "seducir_habla": {
            img: JOHN_SALA,
            text: "Vaya... No sabía que Santa Claus sería tan joven... y tan atractivo.",
            name: "Tú",
            next: "seducir_habla_2"
        },
        "seducir_habla_2": {
            img: JOHN_SALA,
            text: "Si lo hubiera sabido, te habría dejado la chimenea encendida.",
            name: "Tú",
            next: "john_rie_1"
        },
        "john_rie_1": {
            img: JOHN_RIE,
            text: "Jajaja...",
            name: "John Red",
            next: "john_interesante"
        },
        "john_interesante": {
            img: JOHN_RIE,
            text: "Interesante. Muy interesante. Normalmente la gente grita o corre cuando me ve. Pero tú...",
            name: "John Red",
            next: "john_regalos"
        },
        "john_regalos": {
            img: JOHN_RIE,
            text: "Tú pareces querer abrir tus regalos antes de tiempo.",
            name: "John Red",
            next: "john_pregunta"
        },
        "john_pregunta": {
            img: JOHN_RIE,
            text: "Dime... ¿Has sido una chica mala este año?",
            name: "John Red",
            choices: [
                { text: "He sido una buena chica... merezco algo bueno, ¿verdad?", target: "ruta_buena" },
                { text: "He sido buena... pero ahora quiero hacer cosas malas.", target: "ruta_mala" }
            ]
        },

        // --- RUTA CHICA BUENA (FINAL MALO 3) ---
        "ruta_buena": {
            img: JOHN_RIE,
            text: "Intento sonreír dulcemente, esperando que la inocencia me salve.",
            name: "Tú",
            next: "buena_habla"
        },
        "buena_habla": {
            img: JOHN_RIE,
            text: "He sido una buena chica todo el año. Merezco algo bueno, ¿verdad?",
            name: "Tú",
            next: "john_buena"
        },
        "john_buena": {
            img: JOHN_RIE,
            text: "¿Ah, sí? Mmm... Las chicas buenas merecen recompensas especiales.",
            name: "John Red",
            next: "john_ojos"
        },
        "john_ojos": {
            img: JOHN_RIE,
            text: "Anda, cierra los ojos y extiende las manos. No hagas trampa.",
            name: "John Red",
            next: "buena_pensar"
        },
        "buena_pensar": {
            img: JOHN_RIE,
            text: "Gracias a Dios... funcionó. Solo quiere dejarme un regalo y irse.",
            name: "Tú",
            next: "buena_alivio"
        },
        "buena_alivio": {
            img: BG_NEGRO,
            text: "Cierro los ojos, sintiendo un leve alivio",
            name: "Tú",
            next: "buena_espera"
        },
        "buena_espera": {
            img: BG_NEGRO,
            text: "Espero...",
            name: "Tú",
            next: "buena_puntos"
        },
        "buena_puntos": {
            img: BG_NEGRO,
            text: "...",
            name: "Tú",
            sound: "shake",
            next: "muerte_3"
        },
        "muerte_3": {
            img: PANTALLA_MUERTE,
            text: "¡Ah...! ¿Por... qué...?",
            name: "Tú",
            next: "muerte_3_2"
        },
        "muerte_3_2": {
            img: PANTALLA_MUERTE,
            text: "El dolor es agudo en mi pecho. No puedo respirar",
            name: "Tú",
            next: "john_regalo"
        },
        "john_regalo": {
            img: PANTALLA_MUERTE,
            text: "¿Te gusta mi regalo?",
            name: "John Red",
            next: "john_artista"
        },
        "john_artista": {
            img: PANTALLA_MUERTE,
            text: "Verás, preciosa... para un artista como yo, no hay regalo más hermoso que quitar una vida. Feliz Navidad.",
            name: "John Red",
            next: "fin_malo_3"
        },
        "fin_malo_3": {
            img: BG_NEGRO,
            text: "[ FINAL MALO 3: Regalo Equivocado]",
            name: "GAME OVER",
            restart: true
        },

        // --- RUTA CHICA MALA (CONTINUARÁ) ---
        "ruta_mala": {
            img: JOHN_RIE,
            text: "Lo miro directo a los ojos, desafiante. Si voy a morir, será jugando bajo mis propias reglas.",
            name: "Tú",
            next: "mala_habla_1"
        },
        "mala_habla_1": {
            img: JOHN_RIE,
            text: "He sido una buena chica...",
            name: "Tú",
            next: "mala_accion"
        },
        "mala_accion": {
            img: JOHN_RIE,
            text: "Doy un paso más hacia él, invadiendo su espacio personal.",
            name: "Tú",
            next: "mala_habla_2"
        },
        "mala_habla_2": {
            img: JOHN_RIE,
            text: "...pero esta noche quiero hacer cosas malas.",
            name: "Tú",
            next: "john_sorpresa"
        },
        "john_sorpresa": {
            img: JOHN_RIE,
            text: "Jaja... Vaya. Eso no me lo esperaba.",
            name: "John Red",
            next: "mala_mano"
        },
        "mala_mano": {
            img: JOHN_SALA,
            text: "Pongo una mano sobre su pecho, justo sobre el borde de su traje de Santa.",
            name: "Tú",
            next: "mala_pedir"
        },
        "mala_pedir": {
            img: JOHN_SALA,
            text: "Ya que estás aquí... ¿Puedo pedir al Santa como regalo esta noche?",
            name: "Tú",
            next: "john_agarre"
        },
        "john_agarre": {
            img: JOHN_RIE,
            text: "John Red suelta una risa ronca y me agarra de la cintura con fuerza, atrayéndome hacia él.",
            name: "Narración",
            next: "john_devoluciones"
        },
        "john_devoluciones": {
            img: JOHN_SALA,
            text: "Cuidado con lo que deseas... Santa no acepta devoluciones.",
            name: "John Red",
            next: "cuarto_final"
        },
        "cuarto_final": {
            img: JOHN_CUARTO,
            text: "Ni siquiera sé cómo llegué, pero ahora estoy aquí en mi cuarto, y él me mira desde arriba con esa intensidad depredadora.",
            name: "Tú",
            next: "john_valiente"
        },
        "john_valiente": {
            img: JOHN_CUARTO,
            text: "Bien... Vamos a ver si eres tan valiente como pareces.",
            name: "John Red",
            next: "john_olvido"
        },
        "john_olvido": {
            img: JOHN_CUARTO,
            text: "Olvídate de la Navidad. Esta noche solo existimos tú y yo.",
            name: "John Red",
            next: "fin_demo"
        },
        "fin_demo": {
            img: BG_NEGRO,
            text: "FIN DE LA DEMO",
            name: "Sistema",
            restart: true
        }
    };

    /* === MOTOR LÓGICO === */
    let playerName = "Tú";
    const startScreen = document.getElementById("start-screen");
    const nameInput = document.getElementById("player-name-input");
    const startBtn = document.getElementById("start-btn");
    
    const sceneBack = document.getElementById("scene-layer-back");
    const sceneFront = document.getElementById("scene-layer-front");
    const flashOverlay = document.getElementById("flash-overlay");
    const textArea = document.getElementById("text-area");
    const textName = document.getElementById("char-name");
    const textDialog = document.getElementById("dialogue-text");
    const nextBtn = document.getElementById("next-btn");
    const choicesArea = document.getElementById("choices-area");

    // Inicio del juego al hacer clic
    startBtn.onclick = () => {
        const inputName = nameInput.value.trim();
        if(inputName.length > 0) playerName = inputName;
        
        startScreen.classList.add("hidden"); // Ocultar pantalla de nombre
        textArea.classList.remove("hidden"); // Mostrar caja de texto
        
        // Iniciar imágenes
        setLayerImage(sceneBack, story["start"].img);
        renderNode("start");
    };

    function setLayerImage(layer, imgSource) {
        if (imgSource.startsWith("#")) {
            layer.style.backgroundImage = "none";
            layer.style.backgroundColor = imgSource;
        } else {
            layer.style.backgroundColor = "#000";
            layer.style.backgroundImage = `url('${imgSource}')`;
        }
    }

    function renderNode(nodeId) {
        const node = story[nodeId];
        nextBtn.classList.remove("hidden");
        choicesArea.classList.add("hidden");
        choicesArea.innerHTML = "";
        flashOverlay.classList.remove("flash-active");

        // FUSIÓN DE IMÁGENES
        if (node.img) {
            setLayerImage(sceneFront, node.img);
            setTimeout(() => { sceneFront.classList.add("fade-in"); }, 50);
            setTimeout(() => {
                setLayerImage(sceneBack, node.img);
                sceneFront.classList.remove("fade-in");
            }, 550);
        }

        // NOMBRE: Si dice "Tú", ponemos el nombre del jugador
        let displayName = node.name;
        if (displayName === "Tú") displayName = playerName;
        textName.textContent = displayName;
        
        textDialog.textContent = node.text || "...";

        // EFECTOS
        if (node.sound === "shake") {
            document.body.classList.add("shake");
            setTimeout(() => document.body.classList.remove("shake"), 500);
        }
        if (node.effect === "flash") {
            flashOverlay.classList.add("flash-active");
            setTimeout(() => flashOverlay.classList.remove("flash-active"), 200);
        }

        // OPCIONES
        if (node.choices) {
            nextBtn.classList.add("hidden");
            choicesArea.classList.remove("hidden");
            node.choices.forEach(choice => {
                const btn = document.createElement("button");
                btn.className = "btn"; // Estilo unificado
                btn.textContent = choice.text;
                btn.onclick = () => renderNode(choice.target);
                choicesArea.appendChild(btn);
            });
        } else if (node.restart) {
            nextBtn.onclick = () => location.reload();
            nextBtn.textContent = "↻ Reiniciar";
        } else {
            nextBtn.onclick = () => renderNode(node.next);
            nextBtn.textContent = "▼";
        }
    }
</script>
</body>
    </html>
